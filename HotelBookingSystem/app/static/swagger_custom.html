<!DOCTYPE html>
<html>
<head>
    <link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swagger-ui-dist@5/swagger-ui.css">
    <link rel="shortcut icon" href="https://fastapi.tiangolo.com/img/favicon.png">
    <title>Hotel Booking System API Docs</title>
    <style>
        body { background: #f8fafc; font-family: 'Inter', sans-serif; }
        .custom-toolbar {
            display: flex;
            gap: 10px;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            background: #fff;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        .custom-toolbar input, .custom-toolbar select {
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 8px 10px;
            font-size: 14px;
            outline: none;
        }
        .custom-toolbar input:focus, .custom-toolbar select:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 1px #3b82f6;
        }
        .custom-toolbar input {
            flex-grow: 1;
            width: 400px;
        }
        /* ðŸ”¹ Tag color badges */
        .tag-colored {
            color: white !important;
            padding: 5px 12px !important;
            border-radius: 8px;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <div id="swagger-ui"></div>
    <script src="https://cdn.jsdelivr.net/npm/swagger-ui-dist@5/swagger-ui-bundle.js"></script>

    <script>
    const ui = SwaggerUIBundle({
        url: '/openapi.json',
        dom_id: '#swagger-ui',
        layout: 'BaseLayout',
        deepLinking: true,
        showExtensions: true,
        showCommonExtensions: true,
        presets: [
            SwaggerUIBundle.presets.apis,
            SwaggerUIBundle.SwaggerUIStandalonePreset
        ],
        onComplete: () => {

            // ðŸ”¹ Rename username/password â†’ Email/Password
            setInterval(() => {
                const modal = document.querySelector('.modal-ux');
                if (!modal) return;
                modal.querySelectorAll('*').forEach(el => {
                    el.childNodes.forEach(node => {
                        if (node.nodeType === 3) {
                            const text = node.textContent.trim();
                            if (text.includes('username')) node.textContent = text.replace(/username/gi, 'Email');
                            if (text.includes('password')) node.textContent = text.replace(/password/gi, 'Password');
                        }
                    });
                });
            }, 1000);


            // ðŸ”¹ Tag Color Mapping
            const tagColors = {
                // ðŸŸ¢ Core
                rooms: '#22c55e',
                amenities: '#22c55e',
                room_types: '#22c55e',
                room_images: '#22c55e',
                bookings: '#22c55e',
                'booking-edits': '#22c55e',
                // ðŸŸ¡ Intermediate
                offers: '#eab308',
                profile: '#eab308',
                wishlist: '#eab308',
                // ðŸ”´ Admin
                refunds: '#ef4444',
                issues: '#ef4444',
                logs: '#ef4444',
                reports_admin: '#ef4444',
                // ðŸ”µ System
                notifications: '#3b82f6',
                backups: '#3b82f6',
                restores: '#3b82f6',
                reports_customer: '#3b82f6',
                // ðŸŸ£ Access
                roles: '#a855f7',
                auth: '#a855f7',
                // âš« Misc
                content: '#6b7280',
                payments: '#6b7280'
            };

            // ðŸ”¹ Apply color labels to each tag dynamically
            const applyTagColors = () => {
                document.querySelectorAll('.opblock-tag').forEach(tag => {
                    const tagText = tag.textContent.trim().toLowerCase().replace(/\s|-/g, '_');
                    const color = tagColors[tagText];
                    if (color) {
                        tag.classList.add('tag-colored');
                        tag.style.backgroundColor = color;
                    }
                });
            };
            setInterval(applyTagColors, 1500);


            // ðŸ”¹ Add search + filter toolbar
            setTimeout(() => {
                const authWrapper = document.querySelector('.auth-wrapper');
                if (!authWrapper) return;

                const toolbar = document.createElement('div');
                toolbar.className = 'custom-toolbar';

                // ðŸ”¸ Search Input
                const search = document.createElement('input');
                search.type = 'text';
                search.placeholder = 'Search endpoint or module...';

                // ðŸ”¸ Dropdown Filter
                const dropdown = document.createElement('select');
                dropdown.innerHTML = `
<option value=""> ðŸ§­ Show All </option>
<option value="rooms">ðŸŸ¢ Rooms</option>
<option value="amenities">ðŸŸ¢ Amenities</option>
<option value="room_types">ðŸŸ¢ Room Types</option>
<option value="room_images">ðŸŸ¢ Room Images</option>
<option value="bookings">ðŸŸ¢ Bookings</option>
<option value="booking-edits">ðŸŸ¢ Edit Booking</option>
<option value="offers">ðŸŸ¡ Offers</option>
<option value="profile">ðŸŸ¡ Profile</option>
<option value="wishlist">ðŸŸ¡ Wishlist</option>
<option value="refunds">ðŸ”´ Refunds</option>
<option value="issues">ðŸ”´ Issues</option>
<option value="logs">ðŸ”´ Logs</option>
<option value="reports_admin">ðŸ”´ Admin Reports</option>
<option value="notifications">ðŸ”µ Notifications</option>
<option value="backups">ðŸ”µ Backups</option>
<option value="restores">ðŸ”µ Restores</option>
<option value="reports_customer">ðŸ”µ Customer Reports</option>
<option value="roles">ðŸŸ£ Roles</option>
<option value="auth">ðŸŸ£ Auth</option>
<option value="content">âš« Content Management</option>
<option value="payments">âš« Payments</option>
                `;

                dropdown.onchange = function() {
                    const tag = this.value.toLowerCase();
                    document.querySelectorAll('.opblock-tag-section').forEach(sec => {
                        const tagName = sec.querySelector('.opblock-tag').textContent.trim().toLowerCase();
                        sec.style.display = (!tag || tagName.includes(tag)) ? '' : 'none';
                    });
                };

                // ðŸ”¸ Live search
                search.addEventListener('input', function() {
                    const query = this.value.toLowerCase();
                    document.querySelectorAll('.opblock-tag-section').forEach(sec => {
                        const tagText = sec.querySelector('.opblock-tag').textContent.toLowerCase();
                        const endpoints = sec.querySelectorAll('.opblock-summary');
                        let matches = tagText.includes(query);
                        endpoints.forEach(ep => {
                            const txt = ep.textContent.toLowerCase();
                            ep.style.display = txt.includes(query) ? '' : 'none';
                            if (txt.includes(query)) matches = true;
                        });
                        sec.style.display = matches || query === '' ? '' : 'none';
                    });
                });

                toolbar.appendChild(search);
                toolbar.appendChild(dropdown);
                authWrapper.parentNode.insertBefore(toolbar, authWrapper);
            }, 1000);
        }
    });
    </script>
</body>
</html>

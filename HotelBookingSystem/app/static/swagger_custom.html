<!DOCTYPE html>
<html>
<head>
    <link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swagger-ui-dist@5/swagger-ui.css">
    <link rel="shortcut icon" href="https://fastapi.tiangolo.com/img/favicon.png">
    <title>Hotel Booking System API Docs</title>
    <style>
        body { background: #f8fafc; font-family: 'Inter', sans-serif; }
        .custom-toolbar {
            display: flex;
            gap: 10px;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            background: #fff;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        .custom-toolbar input, .custom-toolbar select {
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 8px 10px;
            font-size: 14px;
            outline: none;
        }
        .custom-toolbar input:focus, .custom-toolbar select:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 1px #3b82f6;
        }
        .custom-toolbar input {
            flex-grow: 1;
            width: 400px;
        }
    </style>
</head>
<body>
    <div id="swagger-ui"></div>
    <script src="https://cdn.jsdelivr.net/npm/swagger-ui-dist@5/swagger-ui-bundle.js"></script>

    <script>
    const ui = SwaggerUIBundle({
        url: '/openapi.json',
        dom_id: '#swagger-ui',
        layout: 'BaseLayout',
        deepLinking: true,
        showExtensions: true,
        showCommonExtensions: true,
        presets: [
            SwaggerUIBundle.presets.apis,
            SwaggerUIBundle.SwaggerUIStandalonePreset
        ],
        onComplete: () => {

            // ðŸ”¹ Rename username/password â†’ Email/Password
            setInterval(() => {
                const modal = document.querySelector('.modal-ux');
                if (!modal) return;
                modal.querySelectorAll('*').forEach(el => {
                    el.childNodes.forEach(node => {
                        if (node.nodeType === 3) {
                            const text = node.textContent.trim();
                            if (text.includes('username')) node.textContent = text.replace(/username/gi, 'Email');
                            if (text.includes('password')) node.textContent = text.replace(/password/gi, 'Password');
                        }
                    });
                });
            }, 1000);

            // ðŸ”¹ Add search + filter toolbar
            setTimeout(() => {
                const authWrapper = document.querySelector('.auth-wrapper');
                if (!authWrapper) return;

                const toolbar = document.createElement('div');
                toolbar.className = 'custom-toolbar';

                // ðŸ”¸ Search Input
                const search = document.createElement('input');
                search.type = 'text';
                search.placeholder = 'Search endpoint or module...';

                // ðŸ”¸ Dropdown Filter (no emojis or colors)
                const dropdown = document.createElement('select');
                dropdown.innerHTML = `
<option value="">Show All</option>
<option value="rooms">Rooms</option>
<option value="amenities">Amenities</option>
<option value="room_types">Room Types</option>
<option value="room_images">Room Images</option>
<option value="bookings">Bookings</option>
<option value="booking-edits">Edit Booking</option>
<option value="offers">Offers</option>
<option value="profile">Profile</option>
<option value="wishlist">Wishlist</option>
<option value="refunds">Refunds</option>
<option value="issues">Issues</option>
<option value="logs">Logs</option>
<option value="reports_admin">Admin Reports</option>
<option value="notifications">Notifications</option>
<option value="backups">Backups</option>
<option value="restores">Restores</option>
<option value="reports_customer">Customer Reports</option>
<option value="roles">Roles</option>
<option value="auth">Auth</option>
<option value="content">Content Management</option>
<option value="payments">Payments</option>
                `;

                dropdown.onchange = function() {
                    const tag = this.value.toLowerCase();
                    document.querySelectorAll('.opblock-tag-section').forEach(sec => {
                        const tagName = sec.querySelector('.opblock-tag').textContent.trim().toLowerCase();
                        sec.style.display = (!tag || tagName.includes(tag)) ? '' : 'none';
                    });
                };

                // ðŸ”¸ Live search
                search.addEventListener('input', function() {
                    const query = this.value.toLowerCase();
                    document.querySelectorAll('.opblock-tag-section').forEach(sec => {
                        const tagText = sec.querySelector('.opblock-tag').textContent.toLowerCase();
                        const endpoints = sec.querySelectorAll('.opblock-summary');
                        let matches = tagText.includes(query);
                        endpoints.forEach(ep => {
                            const txt = ep.textContent.toLowerCase();
                            ep.style.display = txt.includes(query) ? '' : 'none';
                            if (txt.includes(query)) matches = true;
                        });
                        sec.style.display = matches || query === '' ? '' : 'none';
                    });
                });

                toolbar.appendChild(search);
                toolbar.appendChild(dropdown);
                authWrapper.parentNode.insertBefore(toolbar, authWrapper);
            }, 1000);
        }
    });
    </script>
</body>
</html>

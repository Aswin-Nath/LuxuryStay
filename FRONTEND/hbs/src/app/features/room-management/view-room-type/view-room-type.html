<app-spinner [isLoading]="loading" message="Loading room type details..."></app-spinner>

<app-admin-navbar></app-admin-navbar>

<div class="bg-gray-50 min-h-screen">
  <div class="flex flex-col lg:flex-row flex-1 w-full mt-16 md:mt-20">
    <!-- Sidebar -->
    <div class="w-full lg:w-64 px-4 md:px-6 lg:px-8 py-4 shrink-0">
      <app-admin-sidebar></app-admin-sidebar>
    </div>

    <!-- Main Content -->
    <main class="flex-1 w-full px-4 md:px-6 lg:px-8 py-4 space-y-4">
      <!-- Header -->
      <div class="relative rounded-lg p-[3px] bg-linear-to-r from-yellow-600 to-red-700 shadow">
        <div class="bg-[#fdfaf4] rounded-lg py-4 md:py-6 px-6">
          <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
            <div>
              <h2 class="text-2xl md:text-3xl text-gray-800 font-bold">Room Type Details</h2>
              <p class="text-gray-600 text-xs md:text-sm mt-1">View complete information about this room type</p>
            </div>
            <button
              (click)="goBack()"
              class="flex items-center gap-2 px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg transition font-medium w-full md:w-auto">
              <span class="material-icons">arrow_back</span>
              Back
            </button>
          </div>
        </div>
      </div>

      <!-- Loading State -->
      <div *ngIf="loading" class="bg-white p-8 text-center rounded-lg shadow">
        <div class="inline-block">
          <div class="animate-spin h-8 w-8 border-4 border-yellow-600 border-t-transparent rounded-full"></div>
        </div>
        <p class="text-gray-600 mt-3 text-sm">Loading room type details...</p>
      </div>

      <!-- Error State -->
      <div *ngIf="error && !loading" class="bg-red-50 border border-red-200 p-4 rounded-lg text-red-700 text-sm">
        {{ error }}
      </div>

      <!-- Content -->
      <div *ngIf="!loading && roomType" class="space-y-4">
        <!-- Basic Information Section -->
        <div class="bg-white rounded-lg shadow p-6 space-y-4">
          <h3 class="text-lg font-semibold text-gray-800">Basic Information</h3>
          
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-600 mb-1">Room Type Name</label>
              <p class="text-lg font-semibold text-gray-900">{{ roomType.type_name }}</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-600 mb-1">Price Per Night</label>
              <p class="text-lg font-semibold text-blue-600">${{ roomType.price_per_night }}</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-600 mb-1">Max Adults</label>
              <p class="text-lg font-semibold text-gray-900">{{ roomType.max_adult_count }}</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-600 mb-1">Max Children</label>
              <p class="text-lg font-semibold text-gray-900">{{ roomType.max_child_count }}</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-600 mb-1">Square Feet</label>
              <p class="text-lg font-semibold text-gray-900">{{ roomType.square_ft }} sq ft</p>
            </div>
          </div>
        </div>

        <!-- Description Section -->
        <div *ngIf="roomType.description" class="bg-white rounded-lg shadow p-6 space-y-4">
          <h3 class="text-lg font-semibold text-gray-800">Description</h3>
          <p class="text-gray-700 text-sm leading-relaxed">{{ roomType.description }}</p>
        </div>

        <!-- Room Stats Section -->
        <div class="grid grid-cols-2 md:grid-cols-5 gap-3">
          <div class="bg-gray-50 rounded-lg p-4 border-l-4 border-gray-600">
            <p class="text-xs text-gray-600 font-medium">Total Rooms</p>
            <p class="text-2xl font-bold text-gray-800">{{ roomStats.totalRooms }}</p>
          </div>
          <div class="bg-green-50 rounded-lg p-4 border-l-4 border-green-600">
            <p class="text-xs text-gray-600 font-medium">Available</p>
            <p class="text-2xl font-bold text-green-600">{{ roomStats.availableRooms }}</p>
          </div>
          <div class="bg-blue-50 rounded-lg p-4 border-l-4 border-blue-600">
            <p class="text-xs text-gray-600 font-medium">Booked</p>
            <p class="text-2xl font-bold text-blue-600">{{ roomStats.bookedRooms }}</p>
          </div>
          <div class="bg-yellow-50 rounded-lg p-4 border-l-4 border-yellow-600">
            <p class="text-xs text-gray-600 font-medium">Maintenance</p>
            <p class="text-2xl font-bold text-yellow-600">{{ roomStats.maintenanceRooms }}</p>
          </div>
          <div class="bg-red-50 rounded-lg p-4 border-l-4 border-red-600">
            <p class="text-xs text-gray-600 font-medium">Frozen</p>
            <p class="text-2xl font-bold text-red-600">{{ roomStats.frozenRooms }}</p>
          </div>
        </div>

        <!-- Amenities Section -->
        <div class="bg-white rounded-lg shadow p-6 space-y-4">
          <h3 class="text-lg font-semibold text-gray-800">Amenities</h3>
          
          <div *ngIf="amenities && amenities.length > 0" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3">
            <div *ngFor="let amenity of amenities" class="flex items-center gap-3 p-3 bg-green-50 border border-green-200 rounded-lg">
              <span class="material-icons text-green-600">check_circle</span>
              <span class="text-gray-800 font-medium text-sm">{{ amenity.amenity_name }}</span>
            </div>
          </div>
          
          <div *ngIf="!amenities || amenities.length === 0" class="text-gray-500 text-sm text-center py-4">
            No amenities assigned to this room type
          </div>
        </div>

        <!-- Images Section -->
        <div class="bg-white rounded-lg shadow p-6 space-y-4">
          <h3 class="text-lg font-semibold text-gray-800">Images</h3>
          
          <div *ngIf="loadingImages" class="text-center py-8">
            <div class="inline-block">
              <div class="animate-spin h-6 w-6 border-4 border-yellow-600 border-t-transparent rounded-full"></div>
            </div>
            <p class="text-gray-600 mt-2 text-sm">Loading images...</p>
          </div>
          
          <div *ngIf="!loadingImages && images && images.length > 0" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3">
            <div *ngFor="let image of images" class="relative group">
              <img [src]="image.image_url" alt="Room" class="w-full h-32 object-cover rounded-lg" [class.ring-2]="image.is_primary" [class.ring-yellow-500]="image.is_primary">
              <div *ngIf="image.is_primary" class="absolute top-2 right-2 bg-yellow-500 text-white rounded-full p-1">
                <span class="material-icons text-xs">star</span>
              </div>
              <div *ngIf="image.caption" class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded-b-lg truncate">
                {{ image.caption }}
              </div>
            </div>
          </div>
          
          <div *ngIf="!loadingImages && (!images || images.length === 0)" class="text-gray-500 text-sm text-center py-8">
            <span class="material-icons text-4xl text-gray-400 block mb-2">image</span>
            <p>No images available for this room type</p>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="bg-white rounded-lg shadow p-6 flex flex-col sm:flex-row gap-3 justify-end">
          <button
            (click)="goBack()"
            class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition font-medium w-full sm:w-auto">
            <span class="material-icons inline mr-2">close</span>Close
          </button>
          <button
            (click)="editRoomType()"
            class="px-6 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition font-medium w-full sm:w-auto">
            <span class="material-icons inline mr-2">edit</span>Edit Room Type
          </button>
        </div>
      </div>
    </main>
  </div>
</div>
